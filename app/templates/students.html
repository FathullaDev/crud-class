<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>{{ otm.title }} — {{ group.group_name }} studentlar</title>
    <style>
        body { font-family: Arial, sans-serif; background:#fafafa; color:#222; }
        .container { width:95%; max-width:1100px; margin:20px auto; background:#fff; padding:18px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
        h1, h2 { text-align:left; margin:8px 0; }
        .top { display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; margin-bottom:12px; }
        .btn { padding:6px 10px; border-radius:6px; text-decoration:none; border:1px solid transparent; cursor:pointer; }
        .btn-back { background:#eef2ff; color:#0d6efd; border-color:#d6e4ff; }
        .btn-add { background:#e8ffe8; color:#198754; border-color:#c6f3c6; }

        table { width:100%; border-collapse:collapse; margin-top:12px; }
        th, td { border:1px solid #e6e6e6; padding:10px; text-align:left; vertical-align:middle; }
        th { background:#f7f7f7; font-weight:700; }
        .actions { display:flex; gap:8px; }
        .small { color:#666; font-size:13px; }
        .empty-row { text-align:center; color:#666; padding:14px; }

        /* group info card */
        .group-card { padding:12px; border-radius:8px; background:#fbfdff; border:1px solid #edf7f0; margin-bottom:12px; }
    </style>
</head>
<body>
<div class="container">
    <div class="top">
        <div>
            <h1>{{ otm.title }}</h1>
            <div class="small"><strong>Guruh:</strong> {{ group.group_name }} — <strong>Kurs:</strong> {{ group.course }}</div>
            <div class="small"><strong>Email:</strong> {{ otm.email|default:"—" }} &nbsp; | &nbsp; <strong>Telefon:</strong> {{ otm.phone|default:"—" }}</div>
        </div>

        <div style="display:flex; gap:8px;">
            <a class="btn btn-back" href="{% url 'groups_by_otm' otm.id %}">← Guruhlar sahifasiga qaytish</a>
            <a class="btn btn-add" href="{% url 'add_student' %}?otm={{ otm.id }}&group={{ group.id }}">+ Student qo'shish</a>
        </div>
    </div>

    <div class="group-card">
        <strong>{{ group.group_name }}</strong>
        <div class="small">Yaratilgan: {{ group.created_ed }} — Yangilangan: {{ group.updated_ed }}</div>
    </div>

    <!-- Students jadvali -->
    {% if students.exists %}
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Ism Familiya</th>
                    <th>Telefon</th>
                    <th>Email</th>
                    <th>Yaratilgan</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for s in students %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ s.name }} {% if s.surname %} {{ s.surname }}{% endif %}</td>
                    <td>{{ s.phone|default:"—" }}</td>
                    <td>{{ s.email|default:"—" }}</td>
                    <td>{{ s.created_ed }}</td>
                    <td>
                        <div class="actions">
                            <a class="btn" href="{% url 'view_student' s.id %}">View</a>
                            <a class="btn" href="{% url 'update_student' s.id %}">Edit</a>
                            <form action="{% url 'delete_student' s.id %}" method="post" style="display:inline" onsubmit="return confirm('Studentni o‘chirishni tasdiqlaysizmi?');">
                                {% csrf_token %}
                                <button type="submit" class="btn">Delete</button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="empty-row">Bu guruhda hozircha studentlar mavjud emas.</div>
    {% endif %}
</div>
</body>
</html>
